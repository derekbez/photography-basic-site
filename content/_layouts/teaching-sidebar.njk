<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ title }}</title>
  <link rel="stylesheet" href="{{ '/css/styles.css' | url }}">
</head>

<body class="layout-teaching">

  <button class="hamburger-btn" id="hamburger-btn" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="sidebar">
    â˜°
  </button>

  <div class="sidebar" id="sidebar">
    <h2 class="sidebar-title">Photography Basics</h2>

    <nav class="sidebar-nav">
      <ul>
        {% for item in collections.all | eleventyNavigation %}
          {%- if not item.data.hideFromNav %}
          <li class="{% if item.url == page.url %}active{% endif %}">
            <a href="{{ item.url | url }}">{{ item.title }}</a>
          </li>
          {%- endif %}
        {% endfor %}
      </ul>
    </nav>

  </div>

  <div class="main-column">
    <main class="content-area">
      {{ content | safe }}
    </main>

    <footer class="site-footer" role="contentinfo">
      <div class="site-footer-inner">
        <p class="site-footer-left"><a href="{{ '/legal/privacy/' | url }}">Privacy & Cookies</a></p>
        <p class="site-footer-right">&copy; {{ site.title | default('Photography Basics') }} {{ 'now' | date('%Y') }}</p>
      </div>
    </footer>
  </div>

  <div id="cookie-consent" class="cookie-banner" role="dialog" aria-labelledby="cookie-title" aria-hidden="true">
    <div class="cookie-inner">
      <p id="cookie-title">We use a tiny cookie to remember your choice. Read our <a href="{{ '/legal/privacy/' | url }}">Privacy & Cookies</a> notice. By continuing you accept this.</p>
      <div class="cookie-actions">
        <button id="cookie-accept" class="cookie-accept">Accept</button>
      </div>
    </div>
  </div>

  <script>
    (function(){
      // Hamburger menu toggle
      const hamburgerBtn = document.getElementById('hamburger-btn');
      const sidebar = document.getElementById('sidebar');
      
      if (hamburgerBtn && sidebar) {
        hamburgerBtn.addEventListener('click', function() {
          const isOpen = sidebar.classList.toggle('open');
          hamburgerBtn.setAttribute('aria-expanded', isOpen);
        });
        
        // Close sidebar when a nav link is clicked
        const navLinks = sidebar.querySelectorAll('a');
        navLinks.forEach(link => {
          link.addEventListener('click', function() {
            sidebar.classList.remove('open');
            hamburgerBtn.setAttribute('aria-expanded', 'false');
          });
        });
        
        // Close sidebar when pressing Escape
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape' && sidebar.classList.contains('open')) {
            sidebar.classList.remove('open');
            hamburgerBtn.setAttribute('aria-expanded', 'false');
          }
        });
      }
      
      // Image tooltips: copy alt text to title attribute for native browser hover
      document.querySelectorAll('main img, article img').forEach(img => {
        if (img.alt && !img.title) {
          img.title = img.alt;
        }
      });
      
      // Cookie consent banner
      var key = 'cookie_consent_v1';
      if (localStorage.getItem(key)) return;
      var banner = document.getElementById('cookie-consent');
      if (!banner) return;
      banner.setAttribute('aria-hidden','false');
      banner.classList.add('show');
      var accept = document.getElementById('cookie-accept');
      if (accept) {
        accept.focus();
        accept.addEventListener('click', function(){
          localStorage.setItem(key, 'accepted');
          banner.setAttribute('aria-hidden','true');
          banner.classList.remove('show');
        });
      }
      banner.addEventListener('keydown', function(e){ if (e.key === 'Escape') { banner.setAttribute('aria-hidden','true'); banner.classList.remove('show'); } });
    })();
  </script>

</body>
</html>
